import { Canvas, Meta, Story } from '@storybook/addon-docs'

<Meta title="IM UI Kit/IM 兼容" />

# IM 兼容

如果您之前接过 IM SDK，并且在自己项目中存在您自己的 IM SDK 实例以及相关的逻辑，请参考下文进行 IM UI Kit 的初始化。

## 第一步，引入工厂函数 NimKitCoreFactory

```tsx
import { NimKitCoreFactory } from '@xkit-yx/im-kit-ui'
```

## 第二步，根据您使用的 SDK 版本，获得 NimKitCore 构造函数

```tsx
const sdkVersion = 1 // 1 或 2，根据您使用的 SDK 传入
const NimKitCore = NimKitCoreFactory(sdkVersion)
```

### 参数说明

| 参数       | 类型   | 必填 | 说明                                                                                                          |
| ---------- | ------ | ---- | ------------------------------------------------------------------------------------------------------------- |
| sdkVersion | Number | 是   | 使用的 IM SDK 版本。详细参考 [初始化](?path=/docs/im-ui-kit-初始化--page) 中 `参数说明` 一节中的 `sdkVersion` |

## 第三步，初始化 nimKitCore 实例对象

```tsx
const nimKitCore = new NimKitCore({
  initOptions,
  otherOptions,
  funcOptions,
})
```

### 参数说明

| 参数         | 类型   | 必填 | 说明                                                                                                                                                                 |
| ------------ | ------ | ---- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| initOptions  | Object | 是   | IM SDK 初始化参数。详细参考 [初始化](?path=/docs/im-ui-kit-初始化--page) 中 `参数说明` 一节中的 `initOptions`                                                        |
| otherOptions | Object | 否   | IM SDK 初始化其他参数。详细参考 [初始化](?path=/docs/im-ui-kit-初始化--page) 中 `参数说明` 一节中的 `otherOptions`                                                   |
| funcOptions  | Object | 否   | IM SDK 初始化回调函数。只有当您传入的 `sdkVersion` 为 `1` 时，才需要传入。详细参考 [初始化](?path=/docs/im-ui-kit-初始化--page) 中 `参数说明` 一节中的 `funcOptions` |

## 第四步，根据 nimKitCore 实例对象获取 IM SDK 实例，并将 nimKitCore 实例对象 传入 IM UI Kit

- 获取 IM SDK 实例

```tsx
const nimKitCore = new NimKitCore({
  initOptions,
  otherOptions,
  funcOptions,
})

// 获取 IM SDK 实例，替换您之前的初始化 SDK 逻辑
const nim = nimKitCore.getNIM()
```

- 传入 IM UI Kit，将 IM UI Kit 初始化

```tsx
import React from 'react'
import { Provider } from '@xkit-yx/im-kit-ui'

const nimKitCore = new NimKitCore({
  initOptions,
  otherOptions,
  funcOptions,
})

const App = () => {
  return (
    <Provider nimKitCore={nimKitCore} initOptions={initOptions}>
      <div className="app">……</div>
    </Provider>
  )
}
```
